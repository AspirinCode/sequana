# coding: utf-8
"""Read mapping for either single end and paired end data using rna-star.

input:
    fastq -> list with one or two fastq.gz
params:
    index -> path to index of reference genome
    ref -> path to the reference genome in fasta format
    read_groups -> "ID:sample_id LB:library_id PL:platform PU:flowcell SM:sample_name"
    kwargs -> tophat config. See https://ccb.jhu.edu/software/tophat/manual.shtml
"""


rule tophat_mapping:
    input:
        __tophat_mapping__input
    log:
        __tophat_mapping__logs
    output:
        __tophat_mapping__output_prefix
    params:
        index = __tophat_mapping__index,
        read_groups = __tophat_mapping__read_groups,
        kwargs = __v__kwargs
    threads:
        __tophat_mapping__threads

    shell:
        """
        tophat --b2-very-sensitive  -o {output} -p {thread} {params.kwargs} {params.index} {input} 2> {log}

        """