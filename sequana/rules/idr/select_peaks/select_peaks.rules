rule select_peaks:
    """
    Rule for selecting optimal peaks after IDR rule
    """
    input:
        rep =__select_peaks__input_rep,
        ppr = __select_peaks__input_ppr,
        pool = __select_peaks__input_pool
    log:
        __select_peaks__logs
    output:
        __select_peaks__output
    shell:
        """
        numPeaks_Rep=$(wc -l {input.rep})
        numPeaks_PPR=$(wc -l {input.ppr})

        if [ ${{numPeaks_Rep}} -gt ${{numPeaks_PPR}} ] ; then opTh=${{numPeaks_Rep}} ;
        else opTh=${{numPeaks_PPR}} ; fi

        cat {input.pool}  | sort -k8nr,8nr| head -n ${{opTh}} > {output} 2> {log}

        """