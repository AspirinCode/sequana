rule snpeff_add_locus_in_fasta:
    """
    SnpEff needs that locus names in the annotation file and contigs name in
    the FASTA file are identical. So, this rule add locus names of the genbank
    file in the FASTA file before the mapping.

    Required input:
        - __snpeff_add_locus_in_fasta__input: FASTA file of the reference.

    Required output:
        - __snpeff_add_locus_in_fasta__output: FASTA file with locus names.

    Required configuration:
        .. code-block:: yaml

            snpeff:
                reference:  # the genbank file
                options:    # result filters options
    """
    input:
        fasta = __snpeff_add_locus_in_fasta__input,
        ann = config["snpeff"]["reference"]
    output:
        fasta = __snpeff_add_locus_in_fasta__output
    log:
        log = __snpeff_add_locus_in_fasta__log
    run:
        from sequana import SnpEff
        
        snpeff = SnpEff(reference=input['ann'], log=log['log'])
        snpeff.add_locus_in_fasta(input['fasta'], output['fasta'])
