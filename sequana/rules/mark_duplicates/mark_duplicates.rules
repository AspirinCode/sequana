rule mark_duplicates:
    """ 
    Mark reads duplicated. Thus, variant caller is aware of reads duplicated.

    Required input:
        __mark_duplicates__input: bam file

    Required output:
        __mark_duplicates__output: bam file
    """
    input:
        __mark_duplicates__input
    output:
        bam = __mark_duplicates__output,
        metrics = __mark_duplicates__metrics
    log:
        __mark_duplicates__log
    params:
        options = config["mark_duplicates"]["options"]
    shell:
        """
        picard MarkDuplicates I={input} \
        O={output.bam} M={output.metrics} > {log} 2>&1
        samtools index {output.bam}
        """
